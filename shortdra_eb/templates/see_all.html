<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<body id="doc-body" style="margin-top: 30px">
<div id="content">
	<div style="text-align:center;">
		<h3>Welcome to <a href="https://github.com/olsonm16/shortdra">Shortdra.</a></h3>		
		<h5><i>The URL shortener to simplify your life.</i><h5>
		<ul>
		  <li><a href="http://hydr.as/create">Home</a></li>
		  <li><a href="http://hydr.as/see_all">See All</a></li>
		</ul>
	<div>
	<br><br>
	<div style="text-align:center;">
		<table style="font-size:11px;"align="center" border="1" id="links">
			<thead><th>String</th><th>URL</th><td>Delete</th></thead>
			<tbody>
				{% for value in links %}
				<tr><td><a href="http://hydr.as/{{value.string}}">{{value.string}}</a></td><td style="max-width: 400px;"><a href="{{value.url}}">{{value.url}}</a></td>
					<td onclick="delete_link(this);" id="{{value.string}}" style="text-align: center; cursor: pointer !important;"><img style="width: 20px; height: 20px;" src="https://cdn1.iconfinder.com/data/icons/business-bicolor-3/512/erase-512.png"></td></tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
</div>
	
<footer> Version 0.2.0. A product of the hydr.as group.</footer>

</body>
</meta>
</html>

<style>

td {
	word-wrap: break-word;
}

footer {
    width: 100%;
    height: 40px;
    position: absolute;
    /* bottom: 0; */
    left: 0;
    font-size: 10px;
    margin-top: 10px;
}

body {
	font-family: "Trebuchet MS";
}

ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
}

li {
    display: inline;
    padding: 5px;
}

a:link {
    color: #006666
}

/* visited link */
a:visited {
    color: #006666
}

/* mouse over link */
a:hover {
    color: #006666
}

/* selected link */
a:active {
    color: #006666
}

</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script>

	$(document).ready(function() {

		now = new Date();

		if (now.getHours() > 21) {
			$("#doc-body").css("background-color","black");
			$("#doc-body").css("color","white");
		};
	});

	function getCookie(name) {
	    var cookieValue = null;
	    if (document.cookie && document.cookie != '') {
	        var cookies = document.cookie.split(';');
	        for (var i = 0; i < cookies.length; i++) {
	            var cookie = jQuery.trim(cookies[i]);
	            // Does this cookie string begin with the name we want?
	            if (cookie.substring(0, name.length + 1) == (name + '=')) {
	                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
	                break;
	            }
	        }
	    }
	    return cookieValue;
	}

	$.ajaxSetup({
	    beforeSend: function(xhr, settings) {
	        if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) {
	            // Only send the token to relative URLs i.e. locally.
	            xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
	        }
	    }
	});

	function delete_link(item) {
    	var id = item.id;
		$.ajax({
	        url : "/delete/",
	        type: "PUT",
	        data: {id: id},
	        success : function(json) {
	        	console.log(json);
	        	item.parentNode.remove();  
	        },
	        error : function(xhr, errmsg, err) {
	                console.log(errmsg, err, xhr);
	            }

		});
	}
</script>